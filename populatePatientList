    <%
    name=Request.Form("name")
    address=Request.Form("address")
    fromAge=Request.Form("fromAge")
    toAge=Request.Form("toAge")

    pageNo = Request.Form("hidden")
    response.write pageNo
    if(pageNo="")then 
        pageNo=1
    End If

    Dim objConn, objRS, sqlString
    set objConn = Server.CreateObject("ADODB.Connection")
    objConn.Open "Provider=Microsoft.Jet.OLEDB.4.0; Data Source=" & Server.MapPath("hospital.mdb")    
    set objRS = Server.CreateObject("ADODB.Recordset")
    
    dim where 
    sqlString = "Select * From Patient "
    if name<>"" Then
        where = where  + "Where Name Like '"&name&"%' "
    End If
    
    if address <> "" Then
        if instr(where, "where")<0 Then
            where = where  + "Where Address Like '"&address&"%' " 
        else
            where = where  + "AND Address Like '"&address&"%' "
        End If       
        
    End If

    if fromAge <>"" Then
        if instr(where, "where")<0 Then
            where = where  + "WHERE Age >="&fromAge&""
        else
            where = where  + "And Age >="&fromAge&""
        End If            
    End If
    
    if toAge <>"" Then
        if instr(where, "where")<0 Then
            where = where  + "Where Age <= "&toAge&""
        else
            where = where  + "AND Age <= "&toAge&""
        End If
    End If    
    
    sqlString=sqlString+where

    
    
    response.write sqlString
    
    objRS.Open sqlString, objConn
    If objRS.EOF = false Then

    aResults = objRS.GetRows()
 
  
    objRS.Close
    objConn.Close
    totalRows = Ubound(aResults,2)+1
    rowPerPage=5
    totalPageNumber= totalRows/rowPerPage
    modevalue=  totalRows mod rowPerPage
    if modevalue > 0 then 
        totalPageNumber= Int(totalPageNumber) + 1
    end if   
    
    startIndex=(rowPerPage*pageNo)-rowPerPage
    endIndex=(rowPerPage*pageNo)-1
    If endIndex>Ubound(aResults,2) Then
        endIndex=Ubound(aResults,2)
    End if
    End if
%>